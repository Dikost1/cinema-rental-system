<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:CinemaRentalSystem.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1100" d:DesignHeight="650"
             x:Class="CinemaRentalSystem.Views.FilmsView"
             x:DataType="vm:FilmsViewModel">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="3*"/>
        </Grid.ColumnDefinitions>

        <!-- Список фильмов -->
        <Border Grid.Column="0" BorderBrush="#BDC3C7" BorderThickness="1" Margin="5" CornerRadius="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" 
                           Text="Список фильмов" 
                           FontSize="16" 
                           FontWeight="Bold" 
                           Margin="10"
                           Foreground="#2C3E50"/>

                <ListBox Grid.Row="1" 
                         ItemsSource="{Binding Films}"
                         SelectedItem="{Binding SelectedFilm}"
                         Margin="5"
                         Background="#ECF0F1">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5">
                                <TextBlock Text="{Binding Title}" 
                                           FontWeight="SemiBold" 
                                           FontSize="14"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Category}" 
                                               FontSize="12" 
                                               Foreground="#7F8C8D"/>
                                    <TextBlock Text=" • " 
                                               FontSize="12" 
                                               Foreground="#7F8C8D"/>
                                    <TextBlock Text="{Binding ReleaseYear}" 
                                               FontSize="12" 
                                               Foreground="#7F8C8D"/>
                                </StackPanel>
                                <TextBlock Text="{Binding Director}" 
                                           FontSize="11" 
                                           Foreground="#95A5A6"
                                           FontStyle="Italic"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>

        <!-- Форма редактирования -->
        <Border Grid.Column="1" BorderBrush="#BDC3C7" BorderThickness="1" Margin="5" CornerRadius="5">
            <ScrollViewer>
                <StackPanel Margin="10">
                    <TextBlock Text="Информация о фильме" 
                               FontSize="16" 
                               FontWeight="Bold" 
                               Margin="0,0,0,15"
                               Foreground="#2C3E50"/>

                    <!-- Общее сообщение об ошибке -->
                    <Border Background="#FFE6E6" 
                            BorderBrush="#E74C3C" 
                            BorderThickness="1" 
                            CornerRadius="3" 
                            Padding="10" 
                            Margin="0,0,0,10"
                            IsVisible="{Binding HasErrorMessage}">
                        <TextBlock Text="{Binding ErrorMessage}" 
                                   Foreground="#C0392B" 
                                   TextWrapping="Wrap"/>
                    </Border>

                    <TextBlock Text="Название кинофильма:" Margin="0,5,0,2"/>
                    <TextBox Text="{Binding EditingFilm.Title, Mode=TwoWay}" Watermark="Введите название фильма..."/>
                    <TextBlock Text="{Binding TitleError}" 
                               Foreground="#E74C3C" 
                               FontSize="11" 
                               Margin="0,2,0,0"
                               IsVisible="{Binding HasTitleError}"/>

                    <TextBlock Text="Категория фильма (боевик, триллер, комедия и др.):" Margin="0,10,0,2"/>
                    <TextBox Text="{Binding EditingFilm.Category, Mode=TwoWay}" Watermark="Например: боевик, фантастика"/>

                    <TextBlock Text="Автор сценария:" Margin="0,10,0,2"/>
                    <TextBox Text="{Binding EditingFilm.Screenwriter, Mode=TwoWay}" Watermark="Имя автора сценария"/>

                    <TextBlock Text="Режиссер-постановщик:" Margin="0,10,0,2"/>
                    <TextBox Text="{Binding EditingFilm.Director, Mode=TwoWay}" Watermark="Имя режиссера"/>

                    <TextBlock Text="Компания-производитель:" Margin="0,10,0,2"/>
                    <TextBox Text="{Binding EditingFilm.ProductionCompany, Mode=TwoWay}" Watermark="Название компании-производителя"/>

                    <TextBlock Text="Год выхода на экран:" Margin="0,10,0,2"/>
                    <NumericUpDown Value="{Binding EditingFilm.ReleaseYear, Mode=TwoWay}" 
                                   Minimum="1800" 
                                   Maximum="2030"
                                   Increment="1"
                                   FormatString="0"/>
                    <TextBlock Text="{Binding ReleaseYearError}" 
                               Foreground="#E74C3C" 
                               FontSize="11" 
                               Margin="0,2,0,0"
                               IsVisible="{Binding HasReleaseYearError}"/>

                    <TextBlock Text="Поставщик киноленты:" Margin="0,10,0,2"/>
                    <ComboBox ItemsSource="{Binding Suppliers}"
                              SelectedItem="{Binding SelectedSupplier, Mode=TwoWay}"
                              HorizontalAlignment="Stretch">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding LegalAddress}" FontSize="11" Foreground="#7F8C8D"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <TextBlock Text="{Binding SupplierError}" 
                               Foreground="#E74C3C" 
                               FontSize="11" 
                               Margin="0,2,0,0"
                               IsVisible="{Binding HasSupplierError}"/>

                    <TextBlock Text="Стоимость приобретения (руб.):" Margin="0,10,0,2"/>
                    <NumericUpDown Value="{Binding EditingFilm.PurchaseCost, Mode=TwoWay}" 
                                   Minimum="0" 
                                   Maximum="10000000"
                                   Increment="1000"
                                   FormatString="N2"/>
                    <TextBlock Text="{Binding PurchaseCostError}" 
                               Foreground="#E74C3C" 
                               FontSize="11" 
                               Margin="0,2,0,0"
                               IsVisible="{Binding HasPurchaseCostError}"/>

                    <!-- Кнопки управления -->
                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0" HorizontalAlignment="Center">
                        <Button Content="Добавить" 
                                Command="{Binding AddCommand}"
                                Background="#27AE60"
                                Foreground="White"
                                Padding="15,8"
                                Margin="5"/>
                        
                        <Button Content="Обновить" 
                                Command="{Binding UpdateCommand}"
                                Background="#3498DB"
                                Foreground="White"
                                Padding="15,8"
                                Margin="5"/>
                        
                        <Button Content="Удалить" 
                                Command="{Binding DeleteCommand}"
                                Background="#E74C3C"
                                Foreground="White"
                                Padding="15,8"
                                Margin="5"/>
                        
                        <Button Content="Очистить" 
                                Command="{Binding ClearCommand}"
                                Background="#95A5A6"
                                Foreground="White"
                                Padding="15,8"
                                Margin="5"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
